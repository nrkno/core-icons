<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>@nrk/core-icons</title>
	<link rel="stylesheet" href="https://static.nrk.no/core-fonts/latest/core-fonts.min.css">
  <link rel="stylesheet" href="https://static.nrk.no/core-css/latest/core-css.min.css">
  <style>
    html { font: 110%/1.5 'LFT Etica',sans-serif; background: #fcfcfc; color: #26292a }
    .prettyprint.prettyprint { overflow: auto; border: 0; padding: 4px 6px; font-size: 14px; background: #f6f6f6 }
    .docs-menu { list-style: none; margin: 0; padding: 20px; font-size: 14px; line-height: 2 }
    .docs-menu a { display: block; text-decoration: none; opacity: .7; transition: .2s }
    .docs-menu a:hover, .docs-menu a:focus, .docs-menu a.is-active { font-weight: 700; opacity: 1 }
    .docs-page h2:not(:first-child) { margin-top: 3rem; padding-top: 3rem; border-top: 1px solid #ddd }
    .docs-page h3 { font-size: 12px; letter-spacing: .05em; text-transform: uppercase; margin: 2em 0 -1em }
    .docs-page p { max-width: 700px; -webkit-font-smoothing: antialiased }.docs-page { padding: 4% }

    @media(min-width:720px){
      .docs-menu { position: fixed; width: 160px; height: 100vh; padding-top: 90px }
      .docs-menu ~ iframe { position: fixed; width: calc(100% - 200px); height: 100% }
      .docs-menu ~ * { margin-left: 200px }
    }
    .docs-icon { border: 1px solid #fcfcfc; color: inherit!important; padding: 9px; transition: .2s }
    .docs-icon a:active { display: inline-block; transform: scale(.9) }
    .docs-icon .nrk-grid > * { font-size: 13px; margin: 5px }
    .docs-icon .nrk-grid > svg { font-size: 10px }
    .docs-ally-icon { display: flex; align-items: center; justify-content: center; min-height: 80px }
    .nrk-color-invert .nrk-color-shade-1 { background: #26292a; border-color: #141517; color: #fff }
    .nrk-color-invert .prettyprint.prettyprint { -webkit-filter: invert(1); filter: invert(1) }
  </style>
</head>
<body>
  <ul class="docs-menu nrk-color-shade-1">
    <li><a href="#">Getting started</a></li>
    <li><a href="#icons">Icons</a></li>
    <li><a href="#a11y">Accessbility</a></li>
    <li><a href="#interact">Interactivity</a></li>
    <li><a href="#faq">FAQ</a></li>
  </ul>
  <article class="docs-page">
    <h2>@nrk/core-icons <img alt="" style="vertical-align:-2px" src="https://img.shields.io/github/release/nrkno/core-icons.svg"></h2>
    <h3>Getting started</h3>
    <p>
      Icons should be used in dimensions <code class="prettyprint">15x15</code> or <code class="prettyprint">30x30</code>.
      Logos size autmatically scale based on surrounding font-size.
      Insert the code below into the <code class="prettyprint">&lt;body&gt;</code> of your page, and all icons
      will be available as <a target="_blank" href="https://css-tricks.com/svg-symbol-good-choice-icons/">svg symbols</a>:
    </p>
    <pre class="prettyprint">&lt;script async src="https://static.nrk.no/core-icons/latest/core-icons.min.js"&gt;&lt;/script&gt;</pre>
    <p><small><strong>NB:</strong> For sharpest rendering on web, scale icons with <code class="prettyprint">font-size: 10px</code> (or other number divisible with 10).</small></p>
    <h3>Shortcuts</h3>
    <p>
      <a class="nrk-button" target="_top" href="https://github.com/nrkno/core-icons/archive/master.zip"><svg width="15" height="15"><use xlink:href="#nrk-download" /></svg> Download icons</a>
      <a class="nrk-button" target="_top" href="https://github.com/nrkno/core-icons">View on Github</a>
    </p>
    <h2 id="icons">Icons</h2>
    <p>
      <label class="nrk-button nrk-color-base" style="transform:none">
        <span class="nrk-sr">Filter icons</span>
        <input type="text" name="search" placeholder="Type to search" style="border:0;outline:0;background:none;font:inherit">
      </label>
      <label class="nrk-button" style="background:#000">
        <span style="font-weight:500;filter:invert(1) grayscale(1) contrast(9)">Choose color</span>
        <input type="color" name="color" class="nrk-sr" value="#000000" onchange="document.body.classList.toggle('nrk-color-invert', get_brightness(document.querySelector('.docs-icons').style.color = this.parentNode.style.background = this.previousElementSibling.textContent = this.value) > 125)">
      </label>
    </p>
    <div class="nrk-grid docs-icons"></div>
    <h2 id="a11y">Accessbility</h2>
    <p>
      Modern versions of assistive technologies will announce SVG content, but there is still a lot of <a target="_blank" href="http://simplyaccessible.com/article/7-solutions-svgs/">differences between browsers</a>.
      To avoid confusion, use the following conventions:
    </p>
    <div class="nrk-grid">
      <div class="nrk-xs-12of12 nrk-md-6of12 nrk-lg-4of12" style="padding-right:15px">
        <div class="nrk-color-shade-1 docs-ally-icon">
          <a class="nrk-button" href="https://nrk.no/">
            G책 til nrk.no
            <svg width="30" height="30" aria-hidden="true" class="nrk-fade"><use xlink:href="#nrk-arrow-right-long" /></svg>
          </a>
        </div>
        <h3>Icon used as decoration</h3>
        <p><small>Use the <code class="prettyprint">aria-hidden="true"</code> attribute to hide the icon from screen readers while keeping it visually perceivable. Example:</small></p>
        <pre class="prettyprint">&lt;a href=&quot;&hellip;&quot;&gt;
  G책 til NRK.no
  &lt;svg aria-hidden="true"&gt;&hellip;&lt;/svg&gt;
&lt;/a&gt;</pre>
      </div>
      <div class="nrk-xs-12of12 nrk-md-6of12 nrk-lg-4of12" style="padding-right:15px">
        <div class="nrk-color-shade-1 docs-ally-icon">
          <a href="https://nrk.no/" aria-label="G책 til nrk.no">
            <svg width="3.5em" height="1.4em" aria-hidden="true"><use xlink:href="#nrk-logo-nrk" /></svg>
          </a>
        </div>
        <h3>Clickable icon</h3>
        <p><small>Add screen reader content to the clickable element with <code class="prettyprint lang-css">aria-label=&quot;&hellip;&quot;</code>, and hide the icon from screen readers with <code class="prettyprint">aria-hidden="true"</code> Example:</small></p>
        <pre class="prettyprint">&lt;a href=&quot;&hellip;&quot; aria-label=&quot;G책 til NRK.no&quot;&gt;
  &lt;svg aria-hidden="true"&gt;&hellip;&lt;/svg&gt;
&lt;/a&gt;</pre>
      </div>

      <div class="nrk-xs-12of12 nrk-md-6of12 nrk-lg-4of12" style="padding-right:15px">
        <div class="nrk-color-shade-1 docs-ally-icon">
          <span role="img" aria-label="NRK">
            <span class="nrk-sr">NRK</span>
            <svg width="3.5em" height="1.4em" aria-hidden="true"><use xlink:href="#nrk-logo-nrk" /></svg>
          </span>
        </div>
        <h3>Non-clickable icon</h3>
        <p><small>Hide the icon from screen readers with <code class="prettyprint">aria-hidden="true"</code>, and add screen reader content to a wrapper with <code class="prettyprint lang-css">role=&quot;img&quot; aria-label=&quot;&hellip;&quot;</code>, as well as inside a <code class="prettyprint lang-css">.nrk-sr</code>. Example:</small></p>
        <pre class="prettyprint">&lt;span role=&quot;img&quot; aria-label=&quot;NRK&quot;&gt;
  &lt;span class=&quot;nrk-sr&quot;&gt;NRK&lt;/span&gt;
  &lt;svg aria-hidden="true"&gt;&hellip;&lt;/svg&gt;
&lt;/span&gt;</pre>
      </div>
      <div class="nrk-xs-12of12 nrk-md-6of12 nrk-lg-4of12" style="padding-right:15px">
        <div class="nrk-color-shade-1 docs-ally-icon">
          <span role="img" aria-label="Terningkast seks" style="transform:translate(-4px, 3px)">
            <span class="nrk-sr">Terningkast seks</span>
            <svg width="30" height="30" aria-hidden="true"><use xlink:href="#nrk-dice-6--active" /></svg>
          </span>
          Fantastisk!
        </div>
        <h3>Icon augmenting meaning</h3>
        <p><small>Hide the icon from screen readers with <code class="prettyprint">aria-hidden="true"</code>, and add screen reader content to a wrapper with <code class="prettyprint lang-css">role=&quot;img&quot; aria-label=&quot;&hellip;&quot;</code>, as well as inside a <code class="prettyprint lang-css">.nrk-sr</code>. Example:</small></p>
        <pre class="prettyprint">&lt;span role=&quot;img&quot; aria-label=&quot;Terningkast seks&quot;&gt;
  &lt;span class=&quot;nrk-sr&quot;&gt;Terningkast seks&lt;/span&gt;
  &lt;svg aria-hidden="true"&gt;&hellip;&lt;/svg&gt;
&lt;/span&gt;
Fantastisk!</pre>
      </div>
      <div class="nrk-xs-12of12 nrk-md-6of12 nrk-lg-4of12" style="padding-right:15px">
        <div class="nrk-color-shade-1 docs-ally-icon">
          <button class="nrk-button nrk-button--o" aria-label="Stop">
            <svg aria-hidden="true"><use xlink:href="#nrk-media-stop" /></svg>
          </button>
        </div>
        <h3>Button with icon</h3>
        <p><small>Hide the icon from screen readers with <code class="prettyprint">aria-hidden="true"</code>.</p>
        <pre class="prettyprint">&lt;button class=&quot;nrk-button nrk-button--o&quot; aria-label=&quot;Stop&quot;&gt;
  &lt;svg aria-hidden="true"&gt;&hellip;&lt;/svg&gt;
&lt;/button&gt;
Fantastisk!</pre>
      </div>
    </div>
    <h2 id="interact">Interactivity</h2>
    <p>WIP</p>
    <h2 id="faq">FAQ</h2>
    <h3>Can I load a subset of icons?</h3>
    <p>
      One of the missions of having a shared iconset, is to provide a consistent and predictabe coding environment across platforms and products.
      Please include the full <a href="https://static.nrk.no/core-icons/latest/core-icons.min.js"><code class="prettyprint">core-icons.min.js</code></a>, even though your product currently is not using all icons.
    </p>
    <h3>How can I request a new icon?</h3>
    <p>
      Please <a target="_blank" href="https://github.com/nrkno/core-icons/issues">see if your icon request</a> already exists, and add a +1 reaction if found.
      For <a target="_blank" href="https://github.com/nrkno/core-icons/issues/new?title=Icon%20Request:%20">new icon requests</a>,
      describe how you plan to use the icon and subjects to be covered. Icon requests are processed by the NRK Design Forum.
    </p>
    <h3>Why loading icons as a javascript-file?</h3>
    <p>
      SVG symbols are <a target="_blank" href="https://css-tricks.com/svg-symbol-good-choice-icons/">great for styling and accessibility</a>,
      but can not load cross domain, or from external file and in IE (9,10,11).
      Javascript provideds us a cacheable, cross-domain method load the icons, withouh adding extra overhead to each html-file.
    </p>
    <h3>What is the naming convention?</h3>
    <p>
      All icons are prefixed with <code class="prettyprint">nrk-</code>  to play nice with existing code.
      Furthermore, we follow <a target="_blank" href="http://getbem.com/">BEM</a> name conventions, so
      all related icons are scopes equally (i.e. <code class="prettyprint">nrk-logo-</code> or <code class="prettyprint">nrk-media-</code>),
      and postfixed with modifiers for states (i.e. <code class="prettyprint">--active</code>)
    </p>
  </article>
  <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=css" defer></script>
  <script src="core-icons.min.js"></script>
  <script>
    const objectMap = (obj, cb) => Object.keys(obj).map((key) => cb(key, obj[key]));
    const groups = {misc:{}};

    const renderGroup = (id, icons) =>
      `<h3 class="nrk-xs-12of12">${id}<br>&nbsp;</h3>${objectMap(icons, renderIcon).join('')}`;

    const renderIcon = (id, types) =>
      `<div class="docs-icon nrk-color-shade-1 nrk-xs-6of12 nrk-lg-3of12" id="${id}">
        ${types.sort().map(renderType).join('')}
      </div>`;

    const renderType = ({id, style: {width, height}}) =>
      `<div class="nrk-grid">
        <svg aria-hidden="true" width="${width||30}" height="${height||30}"><use xlink:href="#${id}" /></svg>
        <div>${id}<br>
          <a href="./${id}.svg" download>SVG</a> | <a href="javascript:svg2pdf('${id}')">PDF</a> |
          <a href="javascript:void(0)" onclick="this.nextElementSibling.select(),document.execCommand('copy')">Copy HTML</a>
          <input type="text" class="nrk-sr" value="&lt;svg width=&quot;${width||30}&quot; height=&quot;${height||30}&quot; aria-hidden=&quot;true&quot;&gt;&lt;use xlink:href=&quot;#${id}&quot; /&gt;&lt;/svg&gt;">
        </div>
      </div>`;

    //Group icons by type and name
    Array.from(document.querySelectorAll('symbol[id]')).forEach((icon) => {
      const name = icon.id.slice(4).split('--')[0]; //without nrk- and state
      const type = name.split('-')[0];
      ((groups[type] = groups[type] || {})[name] = groups[type][name] || []).push(icon);
    });

    //Merge all single-icon groups
    Object.keys(groups).forEach((type) => {
      if(Object.keys(groups[type]).length === 1){
        Object.assign(groups.misc, groups[type]);
        delete groups[type];
      }
    });

    //Calculate RGB brightness
    function get_brightness(hex) {
      // strip off any leading # and expand if the letters long
      hex = hex.replace('#', '').replace(/^(\S)(\S)(\S)$/, '$1$1$2$2$3$3');
      return ((parseInt(hex.substr(0, 2),16) * 299) +
              (parseInt(hex.substr(2, 2),16) * 587) +
              (parseInt(hex.substr(4, 2),16) * 114)) / 1000;
    }

    //Search
    document.addEventListener('input', (event) => {
      if (event.target.name === 'search') {
        Array.from(document.querySelectorAll('.docs-icons > *')).forEach((el) => {
          el.style.display = el.id.indexOf(event.target.value) < 0 ? 'none' : '';
        });
      }
    });

    //Render icon-grid
    document.querySelector('.docs-icons').innerHTML = objectMap(groups, renderGroup).join('');

    //Utilities
    const downloadAs = (fileName, url) => document.body.appendChild(Object.assign(document.createElement('a'), {download: fileName, href: url})).click();
    const loadScript = (src, onload = Function.prototype) => document.body.appendChild(Object.assign(document.createElement('script'), {async:true, onload, src}));
    const getPDFKit = (opt, cb) => window.PDFDocument? cb(new PDFDocument(opt), blobStream()) : loadScript('pdfkit-and-blob-stream.min.js', () => getPDFKit(opt, cb));

    //Convert SVG to PDF using https://github.com/devongovett/pdfkit/
    const svg2pdf = (el, opts, pdf) => {
      if(typeof el === 'string'){
        const svg = document.getElementById(el);
        const {width, height} = svg.viewBox.baseVal;                  //Get size from viewBox
        const color = document.querySelector('[name="color"]').value; //Get color from input
        const scale = 28 / Math.min(width, height);                   //Scale to minimum 28 for iOS

        return getPDFKit({size: [width * scale, height * scale]}, (pdf, blob) => {
          svg2pdf(svg, {color}, pdf.scale(scale));
          pdf.end();
          pdf.pipe(blob).on('finish', () => downloadAs(`${svg.id}.pdf`, blob.toBlobURL('application/pdf')));
        });
      }
      [].forEach.call(el.children, (node) => {
        const fillr = (node.getAttribute('fill-rule') || 'nonzero').replace(/-*(zero|odd)$/, '-$1');
        const color = (val) => String(val).replace(/currentColor/i, opts.color).replace(/none/i, '');
        const float = (key) => parseFloat(node.getAttribute(key), 10) || 0;
        const style = {};

        //Style
        pdf.fillColor(style.fill = color(node.getAttribute('fill') || opts.fill || opts.color));
        pdf.strokeColor(style.stroke = color(node.getAttribute('stroke') || opts.stroke || 'none'));
        pdf.lineWidth(style.lineWidth = Number(node.getAttribute('stroke-width')) || opts.lineWidth || 1);
        pdf.lineJoin(style.lineJoin = node.getAttribute('stroke-linejoin') || opts.lineJoin || 'miter');
        pdf.lineCap(style.lineCap = node.getAttribute('stroke-linecap') || opts.lineCap || 'butt');

        //Draw
        switch(node.nodeName.toLowerCase()){
          case 'g': svg2pdf(node, style, pdf); break;
          case 'path': pdf.path(node.getAttribute('d')); break;
          case 'line': pdf.moveTo(float('x1'), float('y1')).lineTo(float('x2'), float('y2')); break;
          case 'rect': pdf.roundedRect(float('x'), float('y'), float('width'), float('height'), float('rx') || float('ry')); break;
          case 'ellipse': pdf.ellipse(float('cx'), float('cy'), float('rx'), float('ry') || float('rx')); break;
          case 'circle': pdf.circle(float('cx'), float('cy'), float('r')); break;
          case 'polygon': pdf.polygon(node.getAttribute('points')); break;
          default: console.log(`Unsupported shape: ${node.nodeName}`);
        }

        //Paint
        if(style.stroke && style.fill)pdf.fillAndStroke(fillr, style.stroke);
        else if(style.stroke)pdf.stroke(style.stroke);
        else if(style.fill)pdf.fill(fillr);
      });
    };
  </script>
</body>
</html>
